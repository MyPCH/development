#!/bin/bash
#
# Create external secrets in Amazon Secrets Manager
#
# Usage: $0 

if [ -z "$CHART_DIR" ]
then
	echo "\$CHART_DIR required"
	exit
fi

if [ -z "$TEMPLATE_DIR" ]
then
	echo "\$TEMPLATE_DIR required"
	exit
fi

if [ -z "$CLUSTER_NAME" ]
then
	echo "\$CLUSTER_NAME required"
	exit
fi


external_secret <(helm template ${CHART_DIR} -x ${TEMPLATE_DIR}/secrets.yaml) create  ${CLUSTER_NAME} encoded >/dev/null
