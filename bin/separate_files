#!/usr/local/bin/python3
# Generate separate files (into the current directory) from a YAML map  whose keys are the file names and the values are file contents
# Optionally add a header and a footer

import yaml
import sys

input = yaml.safe_load(sys.stdin)
 
if len(sys.argv) >= 2:
    header = sys.argv[1]
else:
    header = None

if len(sys.argv) >= 3:
    footer = sys.argv[2]
else:
    footer = None

for name, manifest in input.items():
    with open(name + "-" + manifest["Kind"] + ".yaml", "w") as out:
       if header is not None:
            out.write(header + "\n")
       yaml.dump(manifest, out)
       if footer is not None:
           out.write(footer + "\n")
       out.flush()
    
