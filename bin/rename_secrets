#!/usr/local/bin/python3

import sys

import yaml


"""
spec:
  template:
    spec:
      containers:
      - env:
        - name: METRICS_APIKEY
          valueFrom:
            secretKeyRef:
              name: highwater
              key: APIKEY
              optional: true
"""


def get_replacement(ref):
    return ref

val=yaml.safe_load(sys.stdin)
try:
    containers = val["spec"]["template"]["spec"]["containers"]
    for cindex, container in enumerate(containers):
        env = container["env"]
        for index, var in enumerate(env):
            if "valueFrom" in var:
                if "secretKeyRef" in var["valueFrom"]:
                    replacement = get_replacement(var["valueFrom"]["secretKeyRef"])
                    val["spec"]["template"]["spec"]["containers"][cindex]["env"][index]["valueFrom"]["secretKeyRef"] = replacement
except:
    pass

print(val)
