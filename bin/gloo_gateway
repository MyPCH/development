#!/bin/bash -xv

templates=$(helm template $1)

echo $templates | mappings | gloo_manifests http | single_file "# Auto-generated file by $(basename $0). Do not edit.
{{ if and (eq .Values.gateway.name \"gloo\") (.Values.http.enabled) }}" "{{ end }}" > $1/templates/gloo-http.yaml

echo $templates | mappings | gloo_manifests https | single_file "# Auto-generated file by $(basename $0). Do not edit.
{{ if and (eq .Values.gateway.name \"gloo\") (.Values.https.enabled) }}" "{{ end }}" > $1/templates/gloo-https.yaml
