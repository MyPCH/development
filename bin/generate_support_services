#!/bin/bash
#
# Install flux into a AWS EKS cluster
#

VALUES_FILES=${1:-~/values.yaml}
CONFIG_FILE=${2:-config.yaml}

QUICKSTART=git@github.com:tidepool-org/eks-quickstart-app-dev.git
CLUSTER_NAME=$(yq r $VALUES_FILE cluster.metadata.name)
DIRECTORY=cluster-${CLUSTER_NAME}
LOCAL=$(yq r $VALUES_FILE repo.local)

export EKSCTL_EXPERIMENTAL=true

eksctl generate profile  -f ${CONFIG_FILE} --git-url=$QUICKSTART --profile-path ${LOCAL}/${DIRECTORY}/base/
