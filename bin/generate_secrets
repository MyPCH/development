#!/bin/bash
#
# Generate secrets from values file
#

if [ $# -ne 2 ]
then 
	echo "Usage: $0 "\${ENVIRONMENT} \${SECRETS_FILE}"
	exit
fi
ENVIRONMENT=$1
SECRETS_FILE=$2

if [ -z "$DEV_REPO" ]
then
	echo "\$DEV_REPO required."
	exit
fi

helm template -f ${SECRETS_FILE} --set global.secrets.enabled=true  --namespace $ENVIRONMENT \
	${DEV_REPO}/charts/tidepool | yq 'filter(.kind == "Secret")'
