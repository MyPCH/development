#!/bin/bash
#
# Change the namespace for all resources in this directory and all subdirectories.
#
# Usage: $0 ${ENVIRONMENT}

ENVIRONMENT=${1:-$(basename $(pwd))}
for file in $(find . -name \*.yaml -print)
do
	grep "kind" $file | grep Namespace >/dev/null
	if [ $? -eq 0 ]
	then
	  yq w -i $file metadata.name ${ENVIRONMENT}
	else
	  yq w -i $file metadata.namespace ${ENVIRONMENT}
	fi
done
