#!/usr/local/bin/python3
import yaml
import sys

input = yaml.safe_load(sys.stdin)
if len(sys.argv) >= 2:
    output_dir = sys.argv[1]
else:
    output_dir = "."
 
if len(sys.argv) >= 3:
    name = sys.argv[2]
else:
    name = "router"

if len(sys.argv) >= 4:
    header = sys.argv[3]
else:
    header = None

if len(sys.argv) >= 5:
    footer = sys.argv[4]
else:
    footer = None

with open(output_dir + "/" + name + ".yaml", "w") as out:
   if header is not None:
       out.write(header + "\n")
   for name, manifest in input.items():
       out.write("--- #file: " + name + "\n")
       yaml.dump(manifest, out)
   if footer is not None:
       out.write(footer + "\n")
   out.flush()
    
