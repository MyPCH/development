#!/bin/bash
# identify virtual hosts in use
# assumes blip is the only service exposing hosts
# assumes blip label
# assumes Ambassador annotations

hosts=$(kubectl get svc -o yaml --all-namespaces -l app=blip | grep host | sed -e "s/ *host: *//")
for host in $hosts
do
   echo $host
   echo $host | sed -e "s/app\.tidepool\.org/api.tidepool.org/"
   echo $host | sed -e "s/app\.tidepool\.org/uploads.tidepool.org/"
done
