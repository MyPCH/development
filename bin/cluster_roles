#!/bin/bash
CLUSTER_NAME=${1:-$CLUSTER_NAME}
CONFIG_REPO=${2:-$(git rev-parse --show-toplevel)}
REGION=${3:-us-west-2}
DEV_REPO=$(realpath ${4:-${CONFIG_REPO}/../development})
CONFIG_FILE=$(realpath $CONFIG_REPO/clusters/${CLUSTER_NAME}/config.yaml)

aws cloudformation create-stack --stack-name "eksctl-${CLUSTER_NAME}-roles" --capabilities CAPABILITY_NAMED_IAM --template-body file://${DEV_REPO}/cf/cluster-roles.yaml --parameters ParameterKey=ClusterName,ParameterValue=${CLUSTER_NAME}     ParameterKey=NodeGroupStackName,ParameterValue=eksctl-${CLUSTER_NAME}-nodegroup-ng-kiam ParameterKey=Region,ParameterValue=${REGION} ParameterKey=AccountNumber,ParameterValue=${TIDEPOOL_AWS_ACCOUNT}
