{{ if eq .Values.gateway.name "gloo" }}
apiVersion: gloo.solo.io/v1
kind: Upstream
metadata:
  labels:
    app: mongodb
    app.kubernetes.io/instance: mongo
    app.kubernetes.io/managed-by: Tiller
    app.kubernetes.io/name: mongo
  name: infra-mongodb-27017
  namespace: .Values.gateway.proxy.namespace
spec:
  discoveryMetadata: {}
  upstreamSpec:
    kube:
      selector:
        app: mongodb
        app.kubernetes.io/instance: mongo
        app.kubernetes.io/name: mongo
      serviceName: mongodb
      serviceNamespace: infra
      servicePort: 27017
{{ end }}
