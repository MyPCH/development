{{ if .Values.fluxcloud.helmrelease.create }}
---
apiVersion: flux.weave.works/v1beta1
kind: HelmRelease
metadata:
  name: fluxcloud
  namespace: {{ .Values.fluxcloud.namespace.name }}
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: fluxcloud
  chart:
    {{- .Values.fluxcloud.helmrelease.chart | toYaml | nindent 4 }}
  values:
    name: fluxcloud
    github: {{ include "charts.fluxcloud.github" . }}
    slack:
      channel: {{ include "charts.fluxcloud.slack.channel" . }}
      username: {{ .Values.fluxcloud.slack.username | quote }}
{{ end }}
