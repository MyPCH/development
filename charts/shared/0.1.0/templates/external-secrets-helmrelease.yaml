{{ if .Values.externalSecrets.enabled }}
apiVersion: flux.weave.works/v1beta1
kind: HelmRelease
metadata:
  name: external-secrets
  namespace: {{ .Release.Namespace }}
spec:
  releaseName: {{.Release.Namespace}}-external-secrets
  chart:
    {{- .Values.externalSecrets.chart | toYaml | nindent 4 }}
    git: git@github.com:godaddy/kubernetes-external-secrets
    path: charts/kubernetes-external-secrets
    ref: master
  values:
    podAnnotations:
      iam.amazonaws.com/role: {{ include "charts.externalSecrets.role" . }}
{{ end }}
