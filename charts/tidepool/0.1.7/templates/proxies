apiVersion: gloo.solo.io/v1
kind: Proxy
metadata:
  creationTimestamp: "2019-09-27T01:57:35Z"
  generation: 970
  labels:
    created_by: gateway-v2
  name: gateway-proxy-v2
  namespace: gloo-system
  resourceVersion: "371663"
  selfLink: /apis/gloo.solo.io/v1/namespaces/gloo-system/proxies/gateway-proxy-v2
  uid: 2ce5a3bd-e0ca-11e9-878a-02a5c9f93c98
spec:
  listeners:
  - bindAddress: '::'
    bindPort: 8080
    httpListener:
      virtualHosts:
      - domains:
        - qa1.development.tidepool.org
        name: qa1.gloo-http
        routes:
        - matcher:
            prefix: /
          redirectAction:
            httpsRedirect: true
      - domains:
        - internal.qa1
        name: qa1.internal
        routes:
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/restricted_tokens
          routeAction:
            single:
              upstream:
                name: qa1-auth-9222
                namespace: qa1
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/provider_sessions
          routeAction:
            single:
              upstream:
                name: qa1-auth-9222
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //request-password-from-uploader
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            - OPTIONS
            regex: //v1/users/[^/]+/data_sources
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            regex: //v1/provider_sessions/[^/]+
          routeAction:
            single:
              upstream:
                name: qa1-auth-9222
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //verification-with-password
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - POST
            prefix: //event/csp-report/violation
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            - DELETE
            regex: //v1/oauth/[^/]+/authorize
          routeAction:
            single:
              upstream:
                name: qa1-auth-9222
                namespace: qa1
        - matcher:
            methods:
            - GET
            regex: //v1/users/[^/]+/data_sets
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/images/.+
          routeAction:
            single:
              upstream:
                name: qa1-image-9226
                namespace: qa1
        - matcher:
            methods:
            - GET
            regex: //v1/oauth/[^/]+/redirect
          routeAction:
            single:
              upstream:
                name: qa1-auth-9222
                namespace: qa1
        - matcher:
            methods:
            - GET
            - POST
            regex: //v1/users/[^/]+/datasets
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //request-password-reset
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //confirm-password-reset
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            regex: //v1/blobs/[^/]+/content
          routeAction:
            single:
              upstream:
                name: qa1-blob-9225
                namespace: qa1
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            regex: //v1/data_sources/[^/]+
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/images
          routeAction:
            single:
              upstream:
                name: qa1-image-9226
                namespace: qa1
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            prefix: //v1/restricted_tokens
          routeAction:
            single:
              upstream:
                name: qa1-auth-9222
                namespace: qa1
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/blobs
          routeAction:
            single:
              upstream:
                name: qa1-blob-9225
                namespace: qa1
        - matcher:
            methods:
            - DELETE
            regex: //v1/users/[^/]+/data
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - POST
            prefix: //v1/device/upload/cl
          routeAction:
            single:
              upstream:
                name: qa1-jellyfish-9122
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //email-verification
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //clinician-details
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //v1/device/data/"
          routeAction:
            single:
              upstream:
                name: qa1-jellyfish-9122
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //browser-warning
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            - DELETE
            regex: //v1/blobs/[^/]+
          routeAction:
            single:
              upstream:
                name: qa1-blob-9225
                namespace: qa1
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            regex: //v1/tasks/[^/*]
          routeAction:
            single:
              upstream:
                name: qa1-task-9224
                namespace: qa1
        - matcher:
            methods:
            - GET
            - DELETE
            regex: //v1/users/[^/*]
          routeAction:
            single:
              upstream:
                name: qa1-user-9221
                namespace: qa1
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //dataservices/
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //v1/synctasks/
          routeAction:
            single:
              upstream:
                name: qa1-jellyfish-9122
                namespace: qa1
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //userservices/
          routeAction:
            single:
              upstream:
                name: qa1-user-9221
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //v1/data_sets
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - POST
            - PUT
            - DELETE
            prefix: //v1/datasets
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - POST
            prefix: //serverlogin
          routeAction:
            single:
              upstream:
                name: qa1-shoreline-9107
                namespace: qa1
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            prefix: //v1/images
          routeAction:
            single:
              upstream:
                name: qa1-image-9226
                namespace: qa1
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //metadata/
          routeAction:
            single:
              upstream:
                name: qa1-seagull-9120
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //patients
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //v1/data/
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //metrics/
          routeAction:
            single:
              upstream:
                name: qa1-highwater-9191
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //confirm/
          routeAction:
            single:
              upstream:
                name: qa1-hydrophone-9157
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //message/
          routeAction:
            single:
              upstream:
                name: qa1-message-api-9119
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - POST
            prefix: //v1/tasks
          routeAction:
            single:
              upstream:
                name: qa1-task-9224
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //profile
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //v1/time
          routeAction:
            single:
              upstream:
                name: qa1-data-9220
                namespace: qa1
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //export/
          routeAction:
            single:
              upstream:
                name: qa1-export-9300
                namespace: qa1
          routePlugins:
            timeout: 120s
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //access/
          routeAction:
            single:
              upstream:
                name: qa1-gatekeeper-9123
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //signup
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //terms
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
        - matcher:
            methods:
            - POST
            prefix: //data/
          routeAction:
            single:
              upstream:
                name: qa1-jellyfish-9122
                namespace: qa1
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //auth/
          routeAction:
            single:
              upstream:
                name: qa1-shoreline-9107
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //data/
          routeAction:
            single:
              upstream:
                name: qa1-tide-whisperer-9127
                namespace: qa1
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //info
          routeAction:
            single:
              upstream:
                name: qa1-jellyfish-9122
                namespace: qa1
        - matcher:
            methods:
            - GET
            prefix: //
          routeAction:
            single:
              upstream:
                name: qa1-blip-3000
                namespace: qa1
      - domains:
        - qa2.development.tidepool.org
        name: qa2.gloo-http
        routes:
        - matcher:
            prefix: /
          redirectAction:
            httpsRedirect: true
      - domains:
        - internal.qa2
        name: qa2.internal
        routes:
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/restricted_tokens
          routeAction:
            single:
              upstream:
                name: qa2-auth-9222
                namespace: qa2
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/provider_sessions
          routeAction:
            single:
              upstream:
                name: qa2-auth-9222
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //request-password-from-uploader
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            - OPTIONS
            regex: //v1/users/[^/]+/data_sources
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            regex: //v1/provider_sessions/[^/]+
          routeAction:
            single:
              upstream:
                name: qa2-auth-9222
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //verification-with-password
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - POST
            prefix: //event/csp-report/violation
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            - DELETE
            regex: //v1/oauth/[^/]+/authorize
          routeAction:
            single:
              upstream:
                name: qa2-auth-9222
                namespace: qa2
        - matcher:
            methods:
            - GET
            regex: //v1/users/[^/]+/data_sets
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/images/.+
          routeAction:
            single:
              upstream:
                name: qa2-image-9226
                namespace: qa2
        - matcher:
            methods:
            - GET
            regex: //v1/oauth/[^/]+/redirect
          routeAction:
            single:
              upstream:
                name: qa2-auth-9222
                namespace: qa2
        - matcher:
            methods:
            - GET
            - POST
            regex: //v1/users/[^/]+/datasets
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //request-password-reset
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //confirm-password-reset
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            regex: //v1/blobs/[^/]+/content
          routeAction:
            single:
              upstream:
                name: qa2-blob-9225
                namespace: qa2
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            regex: //v1/data_sources/[^/]+
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/images
          routeAction:
            single:
              upstream:
                name: qa2-image-9226
                namespace: qa2
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            prefix: //v1/restricted_tokens
          routeAction:
            single:
              upstream:
                name: qa2-auth-9222
                namespace: qa2
        - matcher:
            methods:
            - GET
            - POST
            - DELETE
            regex: //v1/users/[^/]+/blobs
          routeAction:
            single:
              upstream:
                name: qa2-blob-9225
                namespace: qa2
        - matcher:
            methods:
            - DELETE
            regex: //v1/users/[^/]+/data
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - POST
            prefix: //v1/device/upload/cl
          routeAction:
            single:
              upstream:
                name: qa2-jellyfish-9122
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //email-verification
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //clinician-details
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //v1/device/data/"
          routeAction:
            single:
              upstream:
                name: qa2-jellyfish-9122
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //browser-warning
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            - DELETE
            regex: //v1/blobs/[^/]+
          routeAction:
            single:
              upstream:
                name: qa2-blob-9225
                namespace: qa2
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            regex: //v1/tasks/[^/*]
          routeAction:
            single:
              upstream:
                name: qa2-task-9224
                namespace: qa2
        - matcher:
            methods:
            - GET
            - DELETE
            regex: //v1/users/[^/*]
          routeAction:
            single:
              upstream:
                name: qa2-user-9221
                namespace: qa2
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //dataservices/
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //v1/synctasks/
          routeAction:
            single:
              upstream:
                name: qa2-jellyfish-9122
                namespace: qa2
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //userservices/
          routeAction:
            single:
              upstream:
                name: qa2-user-9221
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //v1/data_sets
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - POST
            - PUT
            - DELETE
            prefix: //v1/datasets
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - POST
            prefix: //serverlogin
          routeAction:
            single:
              upstream:
                name: qa2-shoreline-9107
                namespace: qa2
        - matcher:
            methods:
            - GET
            - PUT
            - DELETE
            prefix: //v1/images
          routeAction:
            single:
              upstream:
                name: qa2-image-9226
                namespace: qa2
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //metadata/
          routeAction:
            single:
              upstream:
                name: qa2-seagull-9120
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //patients
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //v1/data/
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //metrics/
          routeAction:
            single:
              upstream:
                name: qa2-highwater-9191
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //confirm/
          routeAction:
            single:
              upstream:
                name: qa2-hydrophone-9157
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //message/
          routeAction:
            single:
              upstream:
                name: qa2-message-api-9119
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            - POST
            prefix: //v1/tasks
          routeAction:
            single:
              upstream:
                name: qa2-task-9224
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //profile
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //v1/time
          routeAction:
            single:
              upstream:
                name: qa2-data-9220
                namespace: qa2
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //export/
          routeAction:
            single:
              upstream:
                name: qa2-export-9300
                namespace: qa2
          routePlugins:
            timeout: 120s
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //access/
          routeAction:
            single:
              upstream:
                name: qa2-gatekeeper-9123
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //signup
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //terms
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
        - matcher:
            methods:
            - POST
            prefix: //data/
          routeAction:
            single:
              upstream:
                name: qa2-jellyfish-9122
                namespace: qa2
        - matcher:
            methods:
            - GET
            - OPTIONS
            - POST
            - PUT
            - PATCH
            - DELETE
            prefix: //auth/
          routeAction:
            single:
              upstream:
                name: qa2-shoreline-9107
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //data/
          routeAction:
            single:
              upstream:
                name: qa2-tide-whisperer-9127
                namespace: qa2
          routePlugins:
            prefixRewrite:
              prefixRewrite: /
        - matcher:
            methods:
            - GET
            prefix: //info
          routeAction:
            single:
              upstream:
                name: qa2-jellyfish-9122
                namespace: qa2
        - matcher:
            methods:
            - GET
            prefix: //
          routeAction:
            single:
              upstream:
                name: qa2-blip-3000
                namespace: qa2
    name: listener-::-8080
    useProxyProto: false
  - bindAddress: '::'
    bindPort: 8443
    httpListener: {}
    name: listener-::-8443
    plugins:
      accessLoggingService:
        accessLog:
        - fileSink:
            jsonFormat:
              authority: '%REQ(:authority)%'
              authorization: '%REQ(authorization)%'
              content: '%REQ(content-type)%'
              duration: '%DURATION%'
              method: '%REQ(:method)%'
              path: '%REQ(:path)%'
              request: '%REQ(x-tidepool-trace-request)%'
              response: '%RESPONSE_CODE%'
              scheme: '%REQ(:scheme)%'
              session: '%REQ(x-tidepool-trace-session)%'
              startTime: '%START_TIME%'
              token: '%REQ(x-tidepool-session-token)%'
              upstream: '%UPSTREAM_CLUSTER%'
            path: /dev/stdout
    useProxyProto: false
status:
  reported_by: gloo
  state: 1
