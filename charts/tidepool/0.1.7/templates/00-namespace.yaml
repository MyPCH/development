{{if .Values.global.environment.namespace.create }}
---
apiVersion: v1
kind: Namespace
metadata:
  name: {{.Release.Namespace}}
  labels:
{{ include "charts.labels.standard .}}
  {{- if eq .Values.global.cluster.mesh.name "istio" }}
    istio-injection: {{ .Values.global.cluster.mesh.create }}
  {{ end }}
  {{- if eq .Values.global.cluster.mesh.name "linkerd" }}
    global.linkerd.io/inject: {{ .Values.global.cluster.mesh.create }}
  {{- end }}
  annotations:
{{- if .Values.namespace.iamPermitted }}
    iam.amazonaws.com/permitted: {{ .Values.namespace.iamPermitted | quote }}
{{- else }}
    iam.amazonaws.com/permitted: "{{- .Values.global.cluster.name -}}.*"
{{- end }}
{{- end }}

