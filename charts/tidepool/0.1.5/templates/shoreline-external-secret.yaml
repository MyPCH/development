{{ if (or (eq .Values.global.secrets.external.source "awsSecretsManager")
          (eq .Values.global.secrets.internal.source "awsSecretsManager")
      ) }}
apiVersion: kubernetes-client.io/v1
kind: ExternalSecret
metadata:
  name: Shoreline
  namespace: {{ .Release.Namespace }}
secretDescriptor:
  backendType: secretsManager
  data:
{{ if (eq .Values.global.secrets.external.source "awsSecretsManager") }}
  - key: {{ .Release.Namespace }}/Shoreline
    name: MailchimpApiKey
    property: MailchimpApiKey
{{ end }}
{{ if (eq .Values.global.secrets.internal.source "awsSecretsManager") }}
  - key: {{ .Release.Namespace }}/Shoreline
    name: ServiceAuth
    property: ServiceAuth
  - key: {{ .Release.Namespace }}/Shoreline
    name: UserLongTermKey
    property: UserLongTermKey
  - key: {{ .Release.Namespace }}/Shoreline
    name: UserMailVerification
    property: UserMailVerification
  - key: {{ .Release.Namespace }}/Shoreline
    name: UserPasswordSalt
    property: UserPasswordSalt
{{ end }}
{{ end }}
