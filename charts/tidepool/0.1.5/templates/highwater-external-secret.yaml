{{ if (or (eq .Values.global.secrets.external.source "awsSecretsManager")
          (eq .Values.global.secrets.internal.source "awsSecretsManager")
      ) }}
apiVersion: kubernetes-client.io/v1
kind: ExternalSecret
metadata:
  name: Highwater
  namespace: {{ .Release.Namespace }}
secretDescriptor:
  backendType: secretsManager
  data:
{{ if (eq .Values.global.secrets.external.source "awsSecretsManager") }}
  - key: {{ .Release.Namespace }}/Highwater
    name: KissmetricsAPIKey
    property: KissmetricsAPIKey
  - key: {{ .Release.Namespace }}/Highwater
    name: KissmetricsToken
    property: KissmetricsToken
  - key: {{ .Release.Namespace }}/Highwater
    name: UCSFKissmetricsAPIKey
    property: UCSFKissmetricsAPIKey
  - key: {{ .Release.Namespace }}/Highwater
    name: UCSFWhitelist
    property: UCSFWhitelist
{{ end }}
{{ if (eq .Values.global.secrets.internal.source "awsSecretsManager") }}
  - key: {{ .Release.Namespace }}/Highwater
    name: UserIdSalt
    property: UserIdSalt
{{ end }}
{{ end }}
