{
   "autoscalerManagedPolicy": {
      "Properties": {
         "PolicyDocument": {
            "Statement": [
               {
                  "Action": [
                     "autoscaling:DescribeAutoScalingInstances",
                     "autoscaling:SetDesiredCapacity",
                     "autoscaling:DescribeAutoScalingGroups",
                     "autoscaling:DescribeTags",
                     "autoscaling:DescribeLaunchConfigurations",
                     "autoscaling:TerminateInstanceInAutoScalingGroup"
                  ],
                  "Effect": "Allow",
                  "Resource": "*"
               }
            ],
            "Version": "2012-10-17"
         }
      },
      "Type": "AWS::IAM::ManagedPolicy"
   },
   "autoscalerRole": {
      "Properties": {
         "AssumeRolePolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "Service": "ec2.amazonaws.com"
                  }
               },
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "AWS": {
                        "Fn::GetAtt": [
                           "kiamRole",
                           "Arn"
                        ]
                     }
                  }
               }
            ],
            "Version": "2012-10-17"
         },
         "ManagedPolicyArns": {
            "Ref": "autoscalerManagedPolicy"
         },
         "RoleName": "development-autoscaler-role"
      },
      "Type": "AWS::IAM::Role"
   },
   "certManagerManagedPolicy": {
      "Properties": {
         "PolicyDocument": {
            "Statement": [
               {
                  "Action": "route53:ChangeResourceRecordSets",
                  "Effect": "Allow",
                  "Resource": "arn:aws:route53:::hostedzone/*"
               },
               {
                  "Action": [
                     "route53:GetChange",
                     "route53:ListHostedZones",
                     "route53:ListResourceRecordSets",
                     "route53:ListHostedZonesByName"
                  ],
                  "Effect": "Allow",
                  "Resource": "*"
               }
            ],
            "Version": "2012-10-17"
         }
      },
      "Type": "AWS::IAM::ManagedPolicy"
   },
   "certManagerRole": {
      "Properties": {
         "AssumeRolePolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "Service": "ec2.amazonaws.com"
                  }
               },
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "AWS": {
                        "Fn::GetAtt": [
                           "kiamRole",
                           "Arn"
                        ]
                     }
                  }
               }
            ],
            "Version": "2012-10-17"
         },
         "ManagedPolicyArns": {
            "Ref": "certManagerManagedPolicy"
         },
         "RoleName": "development-cert-manager-role"
      },
      "Type": "AWS::IAM::Role"
   },
   "defaultManagedPolicy": {
      "Properties": {
         "PolicyDocument": {
            "Version": "2012-10-17"
         },
         "Statements": [
            {
               "Action": "s3:ListBucket",
               "Effect": "Allow",
               "Resource": [
                  "arn:aws:s3:::tidepool-development-default-data/*"
               ]
            },
            {
               "Action": [
                  "s3:GetObject",
                  "s3:PutObject",
                  "s3:DeleteObject"
               ],
               "Effect": "Allow",
               "Resource": [
                  "arn:aws:s3:::tidepool-development-default-data/*"
               ]
            },
            {
               "Action": "ses:*",
               "Effect": "Allow",
               "Resource": "*"
            }
         ]
      },
      "Type": "AWS::IAM::ManagedPolicy"
   },
   "defaultRole": {
      "Properties": {
         "AssumeRolePolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "Service": "ec2.amazonaws.com"
                  }
               },
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "AWS": {
                        "Fn::GetAtt": [
                           "kiamRole",
                           "Arn"
                        ]
                     }
                  }
               }
            ],
            "Version": "2012-10-17"
         },
         "ManagedPolicyArns": {
            "Ref": "defaultManagedPolicy"
         },
         "RoleName": "development-default-role"
      },
      "Type": "AWS::IAM::Role"
   },
   "externalDnsManagedPolicy": {
      "Properties": {
         "PolicyDocument": {
            "Statement": [
               {
                  "Action": "route53:ChangeResourceRecordSets",
                  "Effect": "Allow",
                  "Resource": "arn:aws:route53:::hostedzone/*"
               },
               {
                  "Action": [
                     "route53:GetChange",
                     "route53:ListHostedZones",
                     "route53:ListResourceRecordSets",
                     "route53:ListHostedZonesByName"
                  ],
                  "Effect": "Allow",
                  "Resource": "*"
               }
            ],
            "Version": "2012-10-17"
         }
      },
      "Type": "AWS::IAM::ManagedPolicy"
   },
   "externalDnsRole": {
      "Properties": {
         "AssumeRolePolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "Service": "ec2.amazonaws.com"
                  }
               },
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "AWS": {
                        "Fn::GetAtt": [
                           "kiamRole",
                           "Arn"
                        ]
                     }
                  }
               }
            ],
            "Version": "2012-10-17"
         },
         "ManagedPolicyArns": {
            "Ref": "externalDnsManagedPolicy"
         },
         "RoleName": "development-external-dns-role"
      },
      "Type": "AWS::IAM::Role"
   },
   "externalSecretsManagedPolicy": {
      "Properties": {
         "PolicyDocument": {
            "Statement": [
               {
                  "Action": "secretsmanager:GetSecretValue",
                  "Effect": "Allow",
                  "Resource": [
                     "arn:aws:secretsmanager:us-west-2:123456789012:secret:development/*"
                  ]
               }
            ],
            "Version": "2012-10-17"
         }
      },
      "Type": "AWS::IAM::ManagedPolicy"
   },
   "externalSecretsRole": {
      "Properties": {
         "AssumeRolePolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "Service": "ec2.amazonaws.com"
                  }
               },
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "AWS": {
                        "Fn::GetAtt": [
                           "kiamRole",
                           "Arn"
                        ]
                     }
                  }
               }
            ],
            "Version": "2012-10-17"
         },
         "ManagedPolicyArns": {
            "Ref": "externalSecretsManagedPolicy"
         },
         "RoleName": "development-external-secrets-role"
      },
      "Type": "AWS::IAM::Role"
   },
   "kiamManagedPolicy": {
      "Properties": {
         "PolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Resource": "*"
               }
            ],
            "Version": "2012-10-17"
         }
      },
      "Type": "AWS::IAM::ManagedPolicy"
   },
   "kiamRole": {
      "Properties": {
         "AssumeRolePolicyDocument": {
            "Statement": [
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "AWS": {
                        "Fn::ImportValue": "eksctl-development-nodegroup-ng-kiam::InstanceRoleARN"
                     }
                  }
               },
               {
                  "Action": "sts:AssumeRole",
                  "Effect": "Allow",
                  "Principal": {
                     "Service": "ec2.amazonaws.com"
                  }
               }
            ],
            "Version": "2012-10-17"
         },
         "ManagedPolicyArns": {
            "Ref": "kiamManagedPolicy"
         },
         "RoleName": "development-kiam-role"
      },
      "Type": "AWS::IAM::Role"
   }
}
