#!/bin/bash
# reports the current branch that weave is tracking
weaveargs=$(kubectl get pods -o json | jq '.items[].spec.containers | .[] | select(.name=="flux") | .args')
echo $weaveargs
branch=$(echo $weaveargs | jq '.[] | select(startswith("--git-branch"))' | sed -e "s/--git-branch=//" -e "s/\"//g")
echo $branch
